      - name: Create or Update RDP User with fixed password (vishal7186)
        run: |
          $password = "vishal7186"

          # If user exists, update password via net user (reliable)
          if (Get-LocalUser -Name "RDP" -ErrorAction SilentlyContinue) {
              Write-Host "User 'RDP' exists — updating password..."
              # Update local user password (plain-text) — runs as admin in runner
              net user RDP $password
          } else {
              Write-Host "Creating new user 'RDP'..."
              $securePass = ConvertTo-SecureString $password -AsPlainText -Force
              New-LocalUser -Name "RDP" -Password $securePass -AccountNeverExpires
          }

          # Ensure group membership
          Try {
              Add-LocalGroupMember -Group "Administrators" -Member "RDP" -ErrorAction Stop
          } Catch {
              Write-Warning "Could not add to Administrators: $_"
          }
          Try {
              Add-LocalGroupMember -Group "Remote Desktop Users" -Member "RDP" -ErrorAction Stop
          } Catch {
              Write-Warning "Could not add to Remote Desktop Users: $_"
          }

          # Export creds for later steps (optional)
          echo "RDP_CREDS=User: RDP | Password: $password" >> $env:GITHUB_ENV

          # Verify
          if (-not (Get-LocalUser -Name "RDP" -ErrorAction SilentlyContinue)) {
              Write-Error "User creation/update failed"
              exit 1
          } else {
              Write-Host "RDP user ready."
          }
